{% extends "admin/base_site.html" %}
{% load static %}

{% block title %}{{ title }} | {{ site_title|default:_('Django site admin') }}{% endblock %}

{% block breadcrumbs %}
<div class="breadcrumbs">
    <a href="{% url 'admin:index' %}">Inicio</a>
    &rsaquo; <a href="{% url 'admin:certificates_participant_changelist' %}">Participantes</a>
    &rsaquo; Importar desde CSV
</div>
{% endblock %}

{% block content %}
<div id="content-main">
    <h1>{{ title }}</h1>
    
    <div class="module" style="margin-bottom: 20px; padding: 15px; background-color: #e7f3fe; border-left: 4px solid #2196F3;">
        <h2 style="margin-top: 0;">üìã Instrucciones</h2>
        <p>El archivo CSV debe contener las siguientes columnas:</p>
        <ul>
            <li><strong>DNI</strong>: N√∫mero de DNI (se normalizar√° autom√°ticamente con ceros a la izquierda)</li>
            <li><strong>Nombres y Apellidos</strong>: Nombre completo del participante</li>
            <li><strong>Fecha del Evento</strong>: Fecha en formato DD/MM/YYYY</li>
            <li><strong>Tipo de Asistente</strong>: ASISTENTE, PONENTE o ORGANIZADOR</li>
            <li><strong>Nombre del Evento</strong>: Nombre del evento</li>
        </ul>
        
        <p><strong>Ejemplo de archivo CSV:</strong></p>
        <pre style="background-color: #f5f5f5; padding: 10px; border-radius: 4px;">DNI,Nombres y Apellidos,Fecha del Evento,Tipo de Asistente,Nombre del Evento
1234567,Juan P√©rez Garc√≠a,15/11/2025,ASISTENTE,Capacitaci√≥n 2025
00123456,Mar√≠a L√≥pez,15/11/2025,PONENTE,Capacitaci√≥n 2025</pre>
        
        <p><strong>üí° Consejo:</strong> Marca la opci√≥n "Solo validar" para revisar el archivo antes de importarlo.</p>
    </div>
    
    <form method="post" enctype="multipart/form-data" class="module">
        {% csrf_token %}
        
        {% if form.errors %}
        <div class="errornote">
            <p>Por favor corrija los siguientes errores:</p>
            {{ form.errors }}
        </div>
        {% endif %}
        
        <fieldset class="module aligned">
            <div class="form-row">
                <div>
                    <label for="id_csv_file" class="required">{{ form.csv_file.label }}:</label>
                    {{ form.csv_file }}
                    {% if form.csv_file.help_text %}
                    <p class="help">{{ form.csv_file.help_text }}</p>
                    {% endif %}
                    {% if form.csv_file.errors %}
                    <p class="errornote">{{ form.csv_file.errors }}</p>
                    {% endif %}
                </div>
            </div>
            
            <div class="form-row">
                <div>
                    <label for="id_validate_only">
                        {{ form.validate_only }}
                        {{ form.validate_only.label }}
                    </label>
                    {% if form.validate_only.help_text %}
                    <p class="help">{{ form.validate_only.help_text }}</p>
                    {% endif %}
                </div>
            </div>
        </fieldset>
        
        <div class="submit-row">
            <input type="submit" value="Procesar Archivo" class="default" />
            <a href="{% url 'admin:certificates_participant_changelist' %}" class="button cancel-link">Cancelar</a>
        </div>
    </form>
    
    <div class="module" style="margin-top: 20px; padding: 15px; background-color: #fff3cd; border-left: 4px solid #ffc107;">
        <h3 style="margin-top: 0;">‚ö†Ô∏è Importante</h3>
        <ul>
            <li>Los DNI se normalizar√°n autom√°ticamente con ceros a la izquierda (ej: 1234567 ‚Üí 01234567)</li>
            <li>Si un participante ya existe, se actualizar√°n sus datos</li>
            <li>El archivo debe estar en formato CSV (separado por comas)</li>
            <li>Tama√±o m√°ximo: 10MB</li>
        </ul>
    </div>
</div>
{% endblock %}
